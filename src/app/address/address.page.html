<ion-header>
  <ion-toolbar class="max-wrap">
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>
      Please share your details<br>
      <small>(Step 3 of 3)</small>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form
    #ngForm="ngForm"
    (ngSubmit)="onSubmitForm($event, ngForm)"
    autocomplete="off"
    class="max-wrap"
  >
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          Your information
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p style="margin: 0;">
          <span class="required">*</span> is a required field.
        </p>
        <ion-list>
          <ion-item>
            <ion-label position="stacked"
              >Forename<span class="required">*</span></ion-label
            >
            <ion-input
              [(ngModel)]="form.forename"
              name="forename"
              required="true"
              placeholder="Your first name"
            ></ion-input>
            <ion-text
              [hidden]="ngForm.controls.forename && (ngForm.controls.forename.valid || (ngForm.controls.forename.pristine))"
              color="danger"
              >Forename is required</ion-text
            >
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Surname</ion-label>
            <ion-input
              [(ngModel)]="form.surname"
              name="surname"
              placeholder="Your surname"
            ></ion-input>
          </ion-item>
          <ion-item>
            <ion-label position="stacked"
              >Contact Number<span class="required">*</span></ion-label
            >
            <ion-input
              [(ngModel)]="form.telephone"
              name="telephone"
              required
              placeholder="Your contact telephone number"
            ></ion-input>
            <ion-text
              [hidden]="ngForm.controls.telephone && (ngForm.controls.telephone.valid || (ngForm.controls.telephone.pristine))"
              color="danger"
              >Telephone is required</ion-text
            >
          </ion-item>
          <ion-item>
            <ion-label position="stacked">Email Address</ion-label>
            <ion-input
              [(ngModel)]="form.email"
              name="email"
              placeholder="Your Email Address"
            ></ion-input>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          Your address
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-checkbox
              [(ngModel)]="form.dontShareAddress"
              (ionChange)="onChangeDontShare($event, ngForm)"
              name="dontShareAddress"
              slot="start"
            ></ion-checkbox>
            <ion-label>
              Iâ€™d prefer not to share my address
            </ion-label>
          </ion-item>
          <ng-container>
            <ion-item *ngIf="!form.dontShareAddress">
              <ion-label position="stacked"
                >Address line 1<span class="required">*</span></ion-label
              >
              <ion-input
                [(ngModel)]="form.address1"
                required
                name="address1"
                placeholder="The first line of your address"
              ></ion-input>
              <ion-text
                [hidden]="ngForm.controls.address1 && (ngForm.controls.address1.valid || (ngForm.controls.address1.pristine))"
                color="danger"
                >Address Line 1 is required</ion-text
              >
            </ion-item>
            <ion-item *ngIf="!form.dontShareAddress">
              <ion-label position="stacked">Address line 2</ion-label>
              <ion-input
                [(ngModel)]="form.address2"
                name="address2"
                placeholder="The second line of your address"
              ></ion-input>
            </ion-item>
            <ion-item>
              <ion-label position="stacked"
                >Town/City<span class="required">*</span></ion-label
              >
              <ion-input
                [(ngModel)]="form.town"
                required
                name="town"
                placeholder="Your town or city"
              ></ion-input>
              <ion-text
                [hidden]="ngForm.controls.town && (ngForm.controls.town.valid || (ngForm.controls.town.pristine))"
                color="danger"
                >Town is required</ion-text
              >
            </ion-item>
            <ion-item>
              <ion-label position="stacked"
                >County<span class="required">*</span></ion-label
              >
              <ion-select
                [(ngModel)]="form.county"
                required
                name="county"
                placeholder="Your county"
              >
                <ion-select-option
                  *ngFor="let county of counties"
                  value="{{county}}"
                  >{{county}}</ion-select-option
                >
              </ion-select>

              <ion-text
                [hidden]="ngForm.controls.county && (ngForm.controls.county.valid || (ngForm.controls.county.pristine))"
                color="danger"
                >County is required</ion-text
              >
            </ion-item>

            <ion-item *ngIf="!form.dontShareAddress">
              <ion-label position="stacked"
                >Post code<span class="required">*</span></ion-label
              >
              <ion-input
                [(ngModel)]="form.postCode"
                name="postCode"
                required
                placeholder="Your UK postcode"
              ></ion-input>
              <ion-text
                [hidden]="ngForm.controls.postCode && (ngForm.controls.postCode.valid || (ngForm.controls.postCode.pristine))"
                color="danger"
                >Postcode is required</ion-text
              >
            </ion-item>
          </ng-container>

          <ion-text
            color="danger"
            *ngIf="ngForm.form.status === 'INVALID' && submitted"
          >
            Please fill in all required fields
          </ion-text>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-content>
        <ion-button type="submit">Next</ion-button>
      </ion-card-content>
    </ion-card>
  </form>
</ion-content>
